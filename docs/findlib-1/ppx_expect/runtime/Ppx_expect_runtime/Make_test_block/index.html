<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make_test_block (docs.findlib-1.ppx_expect.runtime.Ppx_expect_runtime.Make_test_block)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../../../../';
let search_urls = ['../../../../../db.js','../../../../../sherlodoc.js'];
</script><script src="../../../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../../index.html">Index</a> &#x00BB; <a href="../../../../../index.html">docs</a> &#x00BB; <a href="../../../../index.html">findlib-1</a> &#x00BB; <a href="../../../index.html">ppx_expect</a> &#x00BB; <a href="../../index.html">runtime</a> &#x00BB; <a href="../index.html">Ppx_expect_runtime</a> &#x00BB; Make_test_block</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Ppx_expect_runtime.Make_test_block</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature">Signature</a></li></ul></nav></div><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter anchored" id="argument-1-C"><a href="#argument-1-C" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-C/index.html">C</a></span><span> : <a href="../../../config_types/Expect_test_config_types/module-type-S/index.html">Expect_test_config_types.S</a></span></code></div></div><h2 id="signature"><a href="#signature" class="anchor"></a>Signature</h2><div class="odoc-spec"><div class="spec value anchored" id="val-read_test_output_no_backtrace_check"><a href="#val-read_test_output_no_backtrace_check" class="anchor"></a><code><span><span class="keyword">val</span> read_test_output_no_backtrace_check : <span><a href="../../../../base/Base/index.html#type-unit">Base.unit</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/index.html#type-string">Base.string</a></span></code></div><div class="spec-doc"><p>Read test output, passing it through the configured sanitization function but not checking for backtraces. Equivalent to <code>[%expect.output]</code>.</p><p>Consuming read.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_test"><a href="#val-run_test" class="anchor"></a><code><span><span class="keyword">val</span> run_test : <span><span class="label">test_id</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Expectation_id.t</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/index.html#type-unit">Base.unit</a></span></code></div><div class="spec-doc"><p>Given a test id:</p><ul><li>Look up the <code>Test_node.t</code> with that id</li><li>Perform a consuming read of current test output, performing sanitization and checking for backtraces</li><li>Compare the consumed output with the output expected by the associated <code>Test_node.t</code></li><li>Record the test outcome in the associated <code>Test_node.t</code></li><li>If the test failed, set the current <code>Test_block</code>'s <code>fail</code> ref to <code>true</code> (so that the test harness will be informed of a failure at the conclusion of this <code>let%expect_test</code> block)</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_suite"><a href="#val-run_suite" class="anchor"></a><code><span><span class="keyword">val</span> run_suite : 
  <span><span class="label">filename_rel_to_project_root</span>:<a href="../../../../base/Base/index.html#type-string">Base.string</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">line_number</span>:<a href="../../../../base/Base/index.html#type-int">Base.int</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">location</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Compact_loc.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">trailing_loc</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Compact_loc.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">body_loc</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Compact_loc.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">formatting_flexibility</span>:
    <span class="xref-unresolved">Ppx_expect_runtime__.Types.Expect_node_formatting.Flexibility.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">expected_exn</span>:
    <span><span>(<span class="xref-unresolved">Ppx_expect_runtime__.Output.Payload.t</span>
     * <span class="xref-unresolved">Ppx_expect_runtime__.Types.Compact_loc.t</span>)</span>
      <a href="../../../../base/Base/index.html#type-option">Base.option</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">trailing_test_id</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Expectation_id.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">exn_test_id</span>:<span class="xref-unresolved">Ppx_expect_runtime__.Types.Expectation_id.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">description</span>:<span><a href="../../../../base/Base/index.html#type-string">Base.string</a> <a href="../../../../base/Base/index.html#type-option">Base.option</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tags</span>:<span><a href="../../../../base/Base/index.html#type-string">Base.string</a> <a href="../../../../base/Base/index.html#type-list">Base.list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">inline_test_config</span>:<span class="xref-unresolved">Ppx_inline_test_lib.config</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">expectations</span>:
    <span><span>(<span class="xref-unresolved">Ppx_expect_runtime__.Types.Expectation_id.t</span>, <a href="../Test_node/index.html#type-t">Test_node.t</a>)</span>
      <a href="../../../../base/Base/List/Assoc/index.html#type-t">Base.List.Assoc.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../../../../base/Base/index.html#type-unit">Base.unit</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../base/Base/index.html#type-unit">Base.unit</a> <a href="argument-1-C/IO/index.html#type-t">C.IO.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../../base/Base/index.html#type-unit">Base.unit</a></span></code></div><div class="spec-doc"><p>Execute a single <code>let%expect_test</code> block through <code>Ppx_inline_test_lib.test</code>.</p><ul><li>Assert that the test is defined in the currently-executing file.</li><li>Generate two implicit <code>Test_node.t</code>s representing trailing output (expectation that there is none) and uncaught exception (expectation that there is none if <code>expected_exn = None</code>, or else that the test raises with <code>expected_exn</code>).</li><li>Add the explicit <code>Test_node.t</code>s in <code>expectations</code> (those actually present in the test body), as well as the two implicit <code>Test_node.t</code>s described above, into the global table of <code>Test_node.t</code>s.</li><li>Run the callback and the tests for trailing output and uncaught exceptions, accumulating the results of each reached &quot;expectation&quot; inside the corresponding <code>Test_node.t</code>.</li><li>After the callback finishes, if any of the expectations do not match, inform the inline testing harness that the test has &quot;failed&quot;.</li></ul></div></div></div></body></html>
