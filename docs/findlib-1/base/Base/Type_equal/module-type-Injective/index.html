<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Injective (docs.findlib-1.base.Base.Type_equal.Injective)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../../../../';
let search_urls = ['../../../../../db.js','../../../../../sherlodoc.js'];
</script><script src="../../../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../../index.html">Index</a> &#x00BB; <a href="../../../../../index.html">docs</a> &#x00BB; <a href="../../../../index.html">findlib-1</a> &#x00BB; <a href="../../../index.html">base</a> &#x00BB; <a href="../../index.html">Base</a> &#x00BB; <a href="../index.html">Type_equal</a> &#x00BB; Injective</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module type <code><span>Type_equal.Injective</span></code></h1><p><code>Injective</code> is an interface that states that a type is injective, where the type is viewed as a function from types to other types. It predates OCaml's support for explicit injectivity annotations in the type system.</p><p>The typical prior usage was:</p><pre class="language-ocaml"><code>  type 'a t
  include Injective with type 'a t := 'a t</code></pre><p>For example, <code>'a list</code> is an injective type, because whenever <code>'a list = 'b list</code>, we know that <code>'a</code> = <code>'b</code>. On the other hand, if we define:</p><pre class="language-ocaml"><code>  type 'a t = unit</code></pre><p>then clearly <code>t</code> isn't injective, because, e.g., <code>int t = bool t</code>, but <code>int &lt;&gt; bool</code>.</p><p>If <code>module M : Injective</code>, then <code>M.strip</code> provides a way to get a proof that two types are equal from a proof that both types transformed by <code>M.t</code> are equal. A typical implementation looked like this:</p><pre class="language-ocaml"><code>  let strip (type a) (type b)
        (Type_equal.T : (a t, b t) Type_equal.t) : (a, b) Type_equal.t =
    Type_equal.T</code></pre><p>This will not type check for all type constructors (certainly not for non-injective ones!), but it's always safe to try the above implementation if you are unsure. If OCaml accepts this definition, then the type is injective. On the other hand, if OCaml doesn't, then the type may or may not be injective. For example, if the definition of the type depends on abstract types that match <code>Injective</code>, OCaml will not automatically use their injectivity, and one will have to write a more complicated definition of <code>strip</code> that causes OCaml to use that fact. For example:</p><pre class="language-ocaml"><code>  module F (M : Type_equal.Injective) : Type_equal.Injective = struct
    type 'a t = 'a M.t * int

    let strip (type a) (type b)
          (e : (a t, b t) Type_equal.t) : (a, b) Type_equal.t =
      let e1, _ = Type_equal.detuple2 e in
      M.strip e1
    ;;
  end</code></pre><p>If in the definition of <code>F</code> we had written the simpler implementation of <code>strip</code> that didn't use <code>M.strip</code>, then OCaml would have reported a type error.</p><ul class="at-tags"><li class="deprecated"><span class="at-tag">deprecated</span> [since 2023-08] OCaml now supports injectivity annotations. [type !'a t] declares that ['a t] is injective with respect to ['a].</li></ul></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-strip"><a href="#val-strip" class="anchor"></a><code><span><span class="keyword">val</span> strip : <span><span><span>(<span><span class="type-var">'a</span> <a href="#type-t">t</a></span>, <span><span class="type-var">'b</span> <a href="#type-t">t</a></span>)</span> <a href="../index.html#type-equal">equal</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../index.html#type-equal">equal</a></span></span></code></div></div></div></body></html>
