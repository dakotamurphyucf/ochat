<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Renderer (ochat.Chat_tui.Renderer)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">ochat</a> &#x00BB; <a href="../index.html">Chat_tui</a> &#x00BB; Renderer</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Chat_tui.Renderer</span></code></h1><p>Terminal renderer â€“ converts immutable chat <a href="../Model/index.html"><code>Model</code></a> data into Notty images.</p><p>The renderer is **pure**: every function in this module returns a value that depends only on its arguments â€“ there are no hidden sideâ€“effects. State that belongs to the UI (scroll offsets, colour scheme, cursor position â€¦) lives in <a href="../Model/index.html"><code>Model</code></a>; this module merely *reads* that state and produces <code>Notty</code> images.</p><p>Design decisions</p><ul><li>The colour palette is centralised here so that it is easy to tweak the visual style in one place.</li><li>Word-wrapping is delegated to <a href="../Util/index.html#val-wrap_line"><code>Util.wrap_line</code></a>. This keeps rendering free from terminal I/O â€“ the logic can be unit-tested without spawning an actual TTY.</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.1.0</li></ul></header><div class="odoc-content"><p><code>attr_of_role role</code> returns the display attribute used to render chat messages coming from <code>role</code>. Unknown roles map to <code>Notty.A.empty</code>.</p><div class="odoc-spec"><div class="spec value anchored" id="val-attr_of_role"><a href="#val-attr_of_role" class="anchor"></a><code><span><span class="keyword">val</span> attr_of_role : <span><a href="../Types/index.html#type-role">Types.role</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Notty</span>.A.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-message_to_image"><a href="#val-message_to_image" class="anchor"></a><code><span><span class="keyword">val</span> message_to_image : 
  <span><span class="label">max_width</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?selected</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Types/index.html#type-message">Types.message</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Notty</span>.I.t</span></code></div><div class="spec-doc"><p><code>message_to_image ~max_width ?selected (role, txt)</code> returns a boxed image of <code>(role, txt)</code>.</p><p>Parameters</p><ul><li><code>max_width</code> â€“ total width available in terminal cells. The rendered text is word-wrapped so that the outer frame never exceeds this width. Must be â‰¥ 1.</li><li><code>?selected</code> â€“ highlights the message by drawing it in reverse video (defaults to <code>false</code>).</li></ul><p>Invariants</p><ul><li>Blank or whitespace-only <code>txt</code> yields <code>Notty.I.empty</code>.</li><li>The result never exceeds <code>max_width</code> columns.</li></ul><p>The first line is prefixed with &quot;<code>role</code>: &quot;, subsequent wrapped lines are indented so that text aligns.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-history_image"><a href="#val-history_image" class="anchor"></a><code><span><span class="keyword">val</span> history_image : 
  <span><span class="label">width</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">messages</span>:<span><a href="../Types/index.html#type-message">Types.message</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">selected_idx</span>:<span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Notty</span>.I.t</span></code></div><div class="spec-doc"><p><code>history_image ~width ~messages ~selected_idx</code> vertically concatenates <code>messages</code> into a scrollable history view.</p><ul><li><code>width</code> â€“ terminal width used for each individual message.</li><li><code>selected_idx</code> â€“ 0-based index of the highlighted message (`None` = no highlight).</li></ul><p>Every message is rendered with <a href="#val-message_to_image"><code>message_to_image</code></a>; the function merely stacks the resulting images with <code>Notty.I.vcat</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-render_full"><a href="#val-render_full" class="anchor"></a><code><span><span class="keyword">val</span> render_full : <span><span class="label">size</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">model</span>:<a href="../Model/index.html#type-t">Model.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Notty</span>.I.t * <span>(int * int)</span></span></code></div><div class="spec-doc"><p><code>render_full ~size:(w, h) ~model</code> computes the complete TUI.</p><p>Returns an image representing the whole screen (history viewport, status-bar, and multi-line input box) **plus** the zero-based cursor position to be provided to <a href="../../Notty_eio/Term/index.html#val-cursor"><code>Notty_eio.Term.cursor</code></a>.</p><p>Notes</p><ul><li><code>size</code> â€“ available terminal area in *cells* (columns Ã— rows).</li><li>The function is side-effect-free except that it may mutate the internal offset of the <a href="../../Notty_scroll_box/index.html#type-t"><code>Notty_scroll_box.t</code></a> stored in <code>model</code> in order to honour the *auto-follow* flag. This is considered part of the modelâ€™s mutable state.</li></ul><p>Performance: the function allocates a fresh image every call; use an external diffing strategy if you need to minimise redraws.</p></div></div></div></body></html>
