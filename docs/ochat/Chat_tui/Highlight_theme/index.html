<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Highlight_theme (ochat.Chat_tui.Highlight_theme)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">ochat</a> &#x00BB; <a href="../index.html">Chat_tui</a> &#x00BB; Highlight_theme</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Chat_tui.Highlight_theme</span></code></h1><p>Attribute theming for syntax highlighting.</p><p>Map TextMate-style scope names (e.g. <code>&quot;keyword.operator&quot;</code>, <code>&quot;string&quot;</code>) to <code>Notty.A.t</code> attributes used by the TUI renderer.</p><p>Definitions</p><ul><li>A theme is an ordered list of rules, each rule pairing a scope prefix with a <code>Notty.A.t</code>.</li><li>A rule matches a scope when its <code>prefix</code> is a dot-segment-aware prefix of the scope: it matches if the scope is exactly <code>prefix</code> or starts with <code>prefix ^ &quot;.&quot;</code>. This avoids accidental matches such as <code>&quot;source.js&quot;</code> matching <code>&quot;source.json&quot;</code>.</li></ul><p>Resolution</p><ul><li>For each scope in <code>scopes</code>, consider all rules whose <code>prefix</code> matches that scope on dot-segment boundaries (see above).</li><li>Each matching rule is assigned a specificity key <code>(segments, exact)</code> where <code>segments</code> is the number of dot-separated segments in <code>prefix</code> and <code>exact</code> is <code>1</code> for an exact match and <code>0</code> for a proper prefix. Rules with larger keys are more specific.</li><li>Among all matches across all scopes, only rules with maximal specificity contribute to the result. Their attributes are composed in theme order using <a href="../Highlight_styles/index.html#val-(++)"><code>Chat_tui.Highlight_styles.(++)</code></a>. Later rules in this maximum-specificity group override earlier ones for overlapping properties (e.g. foreground colour).</li><li>The order of <code>scopes</code> does not affect the result; they are treated as a set. If none of the supplied scopes match any rule, or <code>scopes</code> is empty, <a href="../Highlight_styles/index.html#val-empty"><code>Chat_tui.Highlight_styles.empty</code></a> (equivalently <code>Notty.A.empty</code>) is returned.</li></ul><p>Notes</p><ul><li>Colours and styles come from <code>Notty.A</code>. The visual result depends on terminal capabilities and palette configuration. See <code>Notty.A</code> for attribute semantics.</li><li>Helpers for colours and styles live in <a href="../Highlight_styles/index.html"><code>Chat_tui.Highlight_styles</code></a>.</li><li>The theme is used by <a href="../Highlight_tm_engine/index.html"><code>Chat_tui.Highlight_tm_engine</code></a> to colourize tokens. Callers can further compose attributes with <a href="../Highlight_styles/index.html#val-(++)"><code>Chat_tui.Highlight_styles.(++)</code></a>.</li><li>Resolution is implemented via an internal precompiled index and a small cache keyed by canonicalised scope sets. In the worst case it is linear in the number of rules times the number of scopes provided, but repeated calls with the same scope sets are typically much cheaper. The function is suitable for per-token use in the renderer.</li></ul></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Opaque theme value. Represents an ordered list of <code>prefix -&gt; attr</code> rules.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>empty</code> is the theme with no rules. Always returns <code>Notty.A.empty</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-github_dark"><a href="#val-github_dark" class="anchor"></a><code><span><span class="keyword">val</span> github_dark : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>github_dark</code> matches GitHub Dark Default token colours using truecolor (24-bit). Strings are light azure, keywords salmon, constants/support azure, functions and types purple, HTML/XML tags green, variables orange, comments muted gray. Links are underlined; inline code uses a subtle chip background.</p><p>Uses helpers from <a href="../Highlight_styles/index.html"><code>Chat_tui.Highlight_styles</code></a> (e.g. <code>fg_hex</code>, <code>bg_hex</code>) to approximate the themeâ€™s truecolor definitions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-attr_of_scopes"><a href="#val-attr_of_scopes" class="anchor"></a><code><span><span class="keyword">val</span> attr_of_scopes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">scopes</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Notty</span>.A.t</span></code></div><div class="spec-doc"><p><code>attr_of_scopes theme ~scopes</code> computes the attribute for <code>scopes</code> using <code>theme</code>.</p><p>Among all rules whose prefixes match at least one scope on dot-segment boundaries, rules with maximal specificity are selected, where specificity is <code>(segments, exact)</code> as described in the module documentation. Their attributes are composed in theme order using <a href="../Highlight_styles/index.html#val-(++)"><code>Chat_tui.Highlight_styles.(++)</code></a>. If no rule matches, the result is <a href="../Highlight_styles/index.html#val-empty"><code>Chat_tui.Highlight_styles.empty</code></a>.</p><p>The implementation maintains an internal cache keyed by canonicalised scope sets and uses a precompiled index of rules, so repeated calls for the same <code>scopes</code> are typically very cheap. In the worst case the cost is linear in the number of rules times the number of scopes and remains suitable for per-token calls in the renderer.</p><p>Example â€“ obtain an attribute for an OCaml keyword and add underline:</p><pre class="language-ocaml"><code>  let theme = Chat_tui.Highlight_theme.github_dark in
  let base =
    Chat_tui.Highlight_theme.attr_of_scopes
      theme ~scopes:[ &quot;keyword&quot;; &quot;source.ocaml&quot; ]
  in
  let attr = Chat_tui.Highlight_styles.(base ++ underline) in
  let (_ : Notty.A.t) = attr in
  ()</code></pre></div></div></div></body></html>
